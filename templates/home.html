<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Application Home Page</title>
	<script>
		function getUserInfo() {
		    console.log("getUserInfo called")
		    return {'zid': {{ zid | default(-1000) }}, 'uid': {{ zid | default(-1000) }}, 'first_name': 'Natalie', 'name':'Natalie', "sex":'F'};
		}
		function getFriendData() {
		    console.log("getFriendData called")
			return [{'zid':123, 'uid':123, 'first_name': 'Natalie', 'name':'Portman', "sex":'F'}];
		//    ,{'zid':-2, 'uid':-2, 'first_name': 'Sergeant', 'name':'Cross', "sex":'M'},{'zid':-1, 'uid':-1, 'first_name': 'Steele', 'name':'Steele', "sex":'M'}
		}
		function getAppFriendIds() {
			console.log("getAppFriendIds called")
			return [123];
		}

		function onGameLoaded(seen, popp, canvas) {
			console.log("Game is loaded " +seen +", " + popp + ", " + canvas)
			return
		}
		function openInAppPurchaseAPI(gid, snid, snuid,cid,a,b,c) {
			console.log("Purchase " +gid +", " + snid + ", " + snuid+ ", " + cid+ ", " + a+ ", " + b+ ", " + c)
			return
		}

		function hasPermission(perm, snuid,name) {
			console.log("Perm " +perm +", "  +snuid+ ", " + name)
            return
        }

        function showPermissions(d) {
            console.log("Show Perm " + d)
            return
        }


        zynga = {
		    "ads": {
                "WatchToEarn": {
                    "service": {
                        "available": function () {
                            console.log("W2E avail");
              				return false;
                        },
						"initializeFlash": function(oid, a,b,c) {
							console.log("initF " +oid +", " + a+ ", " + b+ ", " + c);
							return false;
						}
                    }
                }
            }
		}

		statTracker = {
		    "logWorldObjectCount":function () {
                            console.log("World Count");
              				return;
                        }
		}

	</script>
	<!-- debug websocket connection -->
	<script src="//code.jquery.com/jquery-3.4.1.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js"
			integrity="sha256-yr4fRk/GU1ehYJPAs8P4JlTgu0Hdsp4ZKrx8bDEDC3I=" crossorigin="anonymous"></script>
	<script type="text/javascript" charset="utf-8">
        var socket = io();
        socket.on('connect', function () {
            socket.emit('my event', {data: 'I\'m connected!'});

            $('#delete_save').click(function(event) {
				console.log('deleting save');
				// event.preventDefault();

				socket.emit('delete_save', "Deleting save game");

				console.log('deleting cookie');
				// $.cookie("session", null, { path: '/' });
				// $.removeCookie('the_cookie', { path: '/' });

			});

        });
        socket.on('tutorial_step', function (msg) {
            console.log(msg);
            // $('#tutorial_step').prepend('<div>' + JSON.stringify(msg) + '</div>');
            $('#tutorial_step').prepend('<div><span class="req'+msg[6] + ' ' + (parseInt(msg[6].substring(1)) % 2 == 0 ? 'req_even' : 'req_odd' ) + '">' + msg[5] + ': </span><span class="tooltiplink">' + msg[0] + '<span class="tooltip">' + JSON.stringify(msg[3], null, 4).replace(/\n/g, "<br>").replace(/[ ]/g, "&nbsp;") + '</span></span>'
                + (msg[1] || msg[2] ? ' &rarr; ' : '') + (msg[1] ? '<span class="tooltiplink response">' + JSON.stringify(msg[1]) + '<span class="tooltip">' + JSON.stringify(msg[4], null, 4).replace(/\n/g, "<br>").replace(/[ ]/g, "&nbsp;") + '</span></span>' : '') +
                (msg[1] && msg[2] ? ', ' : '') + (msg[2] ? JSON.stringify(msg[2]) : '') + '</div>');
            $('#tutorial_step').scrollTop(0)
        });

        socket.on('world_log', function (msg) {
            console.log(msg);
            $('#world_log').prepend('<div><span class="req'+msg[4] + ' ' + (parseInt(msg[4].substring(1)) % 2 == 0 ? 'req_even' : 'req_odd' ) + '">' + msg[3] + ': </span><span class="tooltiplink">' + msg[0] + '<span class="tooltip">' + JSON.stringify(msg[2], null, 4).replace(/\n/g, "<br>").replace(/[ ]/g, "&nbsp;") +
				'</span></span>' + (msg[1] || msg[1] == 0 ? ' &rarr; ' + msg[1] + (msg[5] ? ', <span class="tooltiplink response">' + JSON.stringify(msg[5]) + '<span class="tooltip">'+ JSON.stringify(msg[7], null, 4).replace(/\n/g, "<br>").replace(/[ ]/g, "&nbsp;") + '</span></span>' : '') + (msg[6] ? ', ' + JSON.stringify(msg[6]) :'')  : '') + '</div>');
            $('#world_log').scrollTop(0)
        });
         socket.on('other_log', function (msg) {
            console.log(msg);
            $('#other_log').prepend('<div><span class="req'+ msg[4] + ' ' + (parseInt(msg[4].substring(1)) % 2 == 0 ? 'req_even' : 'req_odd' ) + '">' + msg[3] + ': </span><span class="tooltiplink">' + msg[0] + '<span class="tooltip">' + JSON.stringify(msg[2], null, 4).replace(/\n/g, "<br>").replace(/[ ]/g, "&nbsp;") +
				'</span></span>' + (msg[1] ? ' &rarr; <span class="tooltiplink response">response<span class="tooltip">' + JSON.stringify(msg[1], null, 4).replace(/\n/g, "<br>").replace(/[ ]/g, "&nbsp;") + '</span></span>' : '')
				+ '</div>');
            $('#other_log').scrollTop(0)
        });




	</script>
	<style>
		.logbox {
			width: 500px;
			height: 200px;
			vertical-align: top;
			overflow-y: scroll;
			z-index: 5;
		}

		.tooltiplink {
			color: olive;
			position: relative;
			display: inline-block;
		}

		.tooltiplink.response {
			color: cadetblue;
		}

		.req_odd {
			color: crimson;
		}

		.tooltiplink .tooltip {
			/* width: 120px; */
			background-color: black;
			color: #fff;
			/* text-align: center; */
			/* padding: 5px 0; */
			padding: 0px 0px 2px 2px;
			/* border-radius: 6px; */

			/* Position the tooltip text - see examples below! */
			/*position: absolute;*/
			position: fixed;
			display: none;

			/*z-index: 1;*/
			z-index: 2000;
			vertical-align: top;
			/* 			bottom: 100%;
                      left: 50%; */

			/* margin-left: -60px; */
			/* Use half of the width (120/2 = 60), to center the tooltip */
		}

		.tooltiplink:hover .tooltip {
			/* z-index: 5; */
			display: inline;
			top: 0;
			left: 118px;

		}

		.tooltiplink:hover {
			position: relative;
		}

		.tooltiplink .tooltip::after {
			content: " ";
			/*position: absolute;*/
			position: fixed;

			top: 100%;
			/* At the bottom of the tooltip */
			left: 50%;
			margin-left: -5px;
			border-width: 5px;
			border-style: solid;
			border-color: black transparent transparent transparent;
		}




	</style>
</head>
<body>
    <h2>
        Raise The Empires pre-alpha 0.2a
    </h2>

<object codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" WIDTH="1000" HEIGHT="750" id="ea" ALIGN="">
				<param NAME=movie VALUE="/files/empire-s.assets.zgncdn.com/assets/109338/ZGame.109338.swf">
				<param name=FlashVars value="serverTime={{ time | default(1308211688) }}&is_staging=true&debugMode=true&generateSchema=1&sn_app_url=&stats=1">  <!--serverTime=1565300889& mute=true& &zlingshot_zoom= skipFacebook=false&decouple_from_facebook=false&decoupled_facebook_id=5452 -->
				<param NAME=quality VALUE=high>
				<param NAME=bgcolor VALUE=#333399>
                <param name="allowFullScreen" value="true" />
				<embed src="/files/empire-s.assets.zgncdn.com/assets/109338/ZGame.109338.swf" allowFullScreen="true" FlashVars="serverTime={{ time | default(1308211688) }}&is_staging=true&debugMode=true&generateSchema=1&sn_app_url=&stats=1" quality=high bgcolor=#333399 WIDTH="1000" HEIGHT="750" NAME="ea" ALIGN="" TYPE="application/x-shockwave-flash" PLUGINSPAGE="http://www.macromedia.com/go/getflashplayer">
				</embed>
			</object>
	<div></div>

<div>
	Go to <a href="nodebug.html">nodebug</a> version. <a href="wipe_session" id="delete_save">Delete</a> save game. <a href="save-editor">Edit</a> save game.
</div>
<table>
	<tr>
		<td><div class="logbox" id="tutorial_step">&nbsp;</div></td>
		<td><div class="logbox" id="world_log">&nbsp;</div></td>
		<td><div class="logbox" id="other_log">&nbsp;</div></td>
	</tr>
</table>

</body>
</html>
